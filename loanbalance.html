<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dhani Finance – Loan Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
  background: #f4f6fb;
  font-family: Inter, sans-serif;
  display: flex;
  justify-content: center;
  padding: 10px;
  margin: 0;
}
.container {
  max-width: 480px;
  width: 100%;
  padding: 10px;
  position: relative;
}

/* LOAN CARD */
.loan-card {
  background: linear-gradient(270deg, #2563eb, #3b82f6, #60a5fa, #2563eb);
  background-size: 800% 800%;
  color: #fff;
  padding: 20px;
  border-radius: 20px;
  margin-bottom: 16px;
  box-shadow: 0 12px 24px rgba(37, 99, 235, 0.3);
  position: relative;
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  animation: cardEntrance 1s ease forwards, gradientShift 15s ease infinite;
  opacity: 0;
  transform: translateY(30px) scale(0.95);
}

/* Light streaks */
.loan-card::before,
.loan-card::after {
  content: "";
  position: absolute;
  width: 200%;
  height: 200%;
  top: -50%;
  left: -50%;
  background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, transparent 60%);
  transform: rotate(0deg);
  animation: streakMove 4s linear infinite;
  pointer-events: none;
}
.loan-card::after {
  animation-duration: 6s;
  background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 70%);
}

/* Sparkles */
.sparkle {
  position: absolute;
  width: 6px;
  height: 6px;
  background: rgba(255,255,255,0.7);
  border-radius: 50%;
  animation: sparkleMove linear infinite;
  pointer-events: none;
}

/* Hover effect */
.loan-card:hover {
  box-shadow: 0 18px 36px rgba(37, 99, 235, 0.4);
  transform: translateY(0) scale(1.02);
}

/* Card text */
.loan-card h3 {
  margin-bottom: 12px;
  font-size: 18px;
  font-weight: 600;
}
.loan-card .value {
  font-size: 30px;
  font-weight: 800;
}
.loan-card .muted {
  color: rgba(255, 255, 255, 0.8);
  margin-top: 6px;
  font-size: 14px;
}
.loan-info {
  display: flex;
  justify-content: space-between;
  margin-top: 12px;
  font-size: 14px;
  font-weight: 500;
}
.loan-info span { opacity: 0.8; }

/* Animations */
@keyframes cardEntrance {
  0% { opacity: 0; transform: translateY(30px) scale(0.95); }
  60% { opacity: 1; transform: translateY(-10px) scale(1.02); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
@keyframes streakMove {
  0% { transform: rotate(0deg) translateX(0); }
  100% { transform: rotate(360deg) translateX(0); }
}
@keyframes sparkleMove {
  0% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
  10% { opacity: 1; scale: 1; }
  90% { opacity: 0; scale: 0; }
  100% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
}

/* RESPONSIVE */
@media (max-width: 480px){
  .container { padding: 5px; }
  .loan-card { padding: 16px; margin: 8px 0; }
  .loan-card h3 { font-size: 16px; }
  .loan-card .value { font-size: 26px; }
  .loan-card .muted { font-size: 12px; }
  .loan-info { font-size: 12px; }
}
</style>
</head>
<body>
<div class="container">

  <!-- LOAN BALANCE CARD -->
  <div class="loan-card">
    <h3>Loan Balance</h3>
    <div class="value">₹ <span id="loanBalance">0</span></div>
    <div class="muted" id="paymentMessage">Remaining amount to be paid</div>

    <div class="loan-info">
      <span>Total: ₹ <span id="totalLoan">0</span></span>
      <span>Paid: ₹ <span id="paidAmount">0</span></span>
    </div>
  </div>

</div>

<!-- FIREBASE SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCsIYVX3OawpDlFZpKU3KpRsfM7QQoyWyY",
    authDomain: "onlineservice-9f153.firebaseapp.com",
    databaseURL: "https://onlineservice-9f153-default-rtdb.firebaseio.com",
    projectId: "onlineservice-9f153",
    storageBucket: "onlineservice-9f153.appspot.com",
    messagingSenderId: "1040271430967",
    appId: "1:1040271430967:web:6325b056257454943d36b2"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Get Aadhaar from localStorage
  const aadhaar = localStorage.getItem("loan_aadhaar");
  if(!aadhaar){ 
    alert("Please login first!");
    window.location.href="index.html"; 
  }

  // Realtime fetch user data
  const userRef = db.ref("loanUsers/" + aadhaar);
  userRef.on("value", snapshot => {
    if(snapshot.exists()){
      const user = snapshot.val();

      const totalLoan = Number(user.totalLoan || user.loanBalance || 0);
      const paidAmount = Number(user.paidAmount || user.amountPaid || 0);
      const remaining = totalLoan - paidAmount;

      document.getElementById("loanBalance").innerText = remaining.toLocaleString();
      document.getElementById("totalLoan").innerText = totalLoan.toLocaleString();
      document.getElementById("paidAmount").innerText = paidAmount.toLocaleString();

      // Remove all verification messages
      document.getElementById("paymentMessage").innerText = "Remaining amount to be paid";
      document.getElementById("paymentMessage").style.color = "rgba(255,255,255,0.8)";

    } else {
      document.getElementById("loanBalance").innerText = "0";
      document.getElementById("totalLoan").innerText = "0";
      document.getElementById("paidAmount").innerText = "0";
      document.getElementById("paymentMessage").innerText = "Remaining amount to be paid";
    }
  });

  // Add sparkles dynamically
  const card = document.querySelector(".loan-card");
  for(let i=0;i<15;i++){
    const sparkle = document.createElement("div");
    sparkle.className = "sparkle";
    sparkle.style.setProperty("--x", Math.random()*100+"px");
    sparkle.style.setProperty("--y", Math.random()*50+"px");
    sparkle.style.animationDuration = (2+Math.random()*3) + "s";
    sparkle.style.left = Math.random()*100 + "%";
    sparkle.style.top = Math.random()*100 + "%";
    card.appendChild(sparkle);
  }
</script>
</body>
</html>
